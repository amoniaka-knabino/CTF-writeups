import json
from os import urandom
from pwn import remote, process
from string import ascii_letters, digits
from itertools import product


ADDR = "207.148.119.58", 5555


def crack(token):
    test_token = bytearray(token)

    test = b'\x02 {"admin": fals'
    for i, (x, y) in enumerate(zip(test, b'\x01{"admin": true}')):
        test_token[i] ^= ord(x) ^ ord(y)

    return ''.join('{:02x}'.format(x) for x in test_token[:32])


if __name__ == '__main__':
    #r = remote(*ADDR)
    r = process('./padwith2019.py')
    token = r.recvline(False).decode('hex')
    new_token = crack(token)
    r.sendline(new_token)
    r.interactive()
