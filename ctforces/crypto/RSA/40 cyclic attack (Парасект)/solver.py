"""
Cyclic Attack
"""

from Crypto.Util.number import *

n, e = (9754240130179587872802263394776514118202837448930355942907868328784445191072963342447243616313452645777162924481691316213304494941409539027067672901834517105802783664691553148474783637982327851913368457136594634856206212558918719080677902721221195922777513175633739632044017920122468196993, 65537)
with open("flag.enc", 'rb') as f:
    flag = bytes_to_long(f.read())
old_flag = flag
for i in range(100):
    flag = pow(flag, e, n)
    temp = long_to_bytes(flag)
    if b'flag' in temp:
        print(temp)
